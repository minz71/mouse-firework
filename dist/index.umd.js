!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).firework=e()}(this,(function(){"use strict";class t{constructor(){this.queue=[]}add(t){return this.queue.push(new i(t)),this}play(){this.queue.forEach((t=>t.play()))}}const e={targets:null,duration:1/0,easing:"linear",delay:0,begin:null,update:null,complete:null};const s=(()=>{const t={linear:()=>t=>t},e={Sine:()=>t=>1-Math.cos(t*Math.PI/2),Expo:()=>t=>t?Math.pow(2,10*t-10):0,Circ:()=>t=>1-Math.sqrt(1-t*t),Back:()=>t=>t*t*(3*t-2),Bounce:()=>t=>{let e,s=4;for(;t<((e=Math.pow(2,--s))-1)/11;);return 1/Math.pow(4,3-s)-7.5625*Math.pow((3*e-2)/22-t,2)}};return["Quad","Cubic","Quart","Quint"].forEach(((t,s)=>{e[t]=()=>t=>Math.pow(t,s+2)})),Object.keys(e).forEach((s=>{const n=e[s];t["easeIn"+s]=n,t["easeOut"+s]=()=>t=>1-n()(1-t),t["easeInOut"+s]=()=>t=>t<.5?n()(2*t)/2:1-n()(-2*t+2)/2,t["easeOutIn"+s]=()=>t=>t<.5?(1-n()(1-2*t))/2:(n()(2*t-1)+1)/2})),t})(),n=["translateX","translateY","translateZ"],a=(t,e)=>t instanceof HTMLElement?"transform"in t.style&&n.includes(e)?"transform":e in t.style?"style":"attribute":"attribute";class i{constructor(t=e){t={...e,...t};const{targets:s,duration:n,easing:a,delay:i,begin:o,update:r,complete:l,...c}=t;this.targets=s,this.duration=n,this.easing=a,this.delay=i,this.begin=o,this.update=r,this.complete=l,this.dest=c||{},this.tl=null,this.isPlay=!1}timeline(){return this.tl||(this.tl=new t),this.tl}play(){this.isPlay||(this.isPlay=!0,(t=>{const e=Date.now()+t.delay,n=e+t.duration,i=!!t.targets,o=[],r=(t,e,s,n,i,o=!1)=>{let r;if("string"==typeof n){if(r=n.endsWith("%")?"%":n.endsWith("px")?"px":null,!r)throw new TypeError("string value must ends with '%' or 'px'");n=parseFloat(n)}let l=o?n:(n-e)*s+e;r&&(l+=r);const c=a(t,i);"transform"===c?t.style.transform=`${i}(${l}${r?"":"px"})`:"style"===c?t.style[i]=l:t[i]=l},l=(n,a,i=!1)=>{t.targets.forEach(((l,c)=>{Object.keys(t.dest).forEach((h=>{let d=parseFloat(o[c][h]),u=t.dest[h];if("object"==typeof u)if(Array.isArray(u)){let n=0;for(;n<u.length&&a-e>=u[n].startTimeStamp;)n++;const{value:o,duration:c,easing:p=t.easing,startTimeStamp:f}=u[n-1];d=n<=1?d:u[n-2].value;const m=s[p]()((a-e-f)/c);a<=e+c+f?r(l,d,m,o,h):i&&r(l,d,m,o,h,i)}else{const{value:n,duration:o,easing:c=t.easing}=u,p=s[c]()((a-e)/o);a<=e+o?r(l,d,p,n,h):i&&r(l,d,p,n,h,i)}else"function"==typeof u&&(u=u(l,c)),r(l,d,n,u,h,i)}))}))},c=()=>{const a=Date.now();if(a>n)l(1,a,!0),"function"==typeof t.complete&&t.complete(t.targets),t.isPlay=!1;else{if(a>=e){const n=s[t.easing]()((a-e)/t.duration);i&&l(n,a),"function"==typeof t.update&&t.update(t.targets)}requestAnimationFrame(c)}};(()=>{if(i){Array.isArray(t.targets)||(t.targets=[t.targets]);for(const e of t.targets){const s={};for(const n in t.dest){const i=t.dest[n],o=a(e,n);if(Array.isArray(i))if(2===i.length&&"object"!=typeof i[0])"transform"===o?e.style.transform=`${n}(${"string"==typeof i[0]?i[0]:i[0]+"px"})`:"style"===o?e.style[n]=i[0]:e[n]=i[0],s[n]=i[0],t.dest[n]=i[1];else{let t=0;for(let e of i)e.startTimeStamp=t,t+=e.duration;s[n]=e[n]}else s[n]="transform"===o?e.style.transform.match(new RegExp(`${n}\\((\\w+)\\)`))[1]:"style"===o?e.style[n]:e[n]}o.push(s)}}})(),"function"==typeof t.begin&&t.begin(t.targets),c()})(this))}}const o=t=>new i(t);o.random=(t,e)=>Math.floor(Math.random()*(e-t+1))+t;const r=t=>Array.isArray(t)?o.random(t[0],t[1]):t,l=t=>Array.isArray(t)?t.map((t=>100*t)):[100*t,100*t];class c{constructor(t,e,s,n,a,i,o){this.ctx=t,this.x=e,this.y=s,this.color=n,this.radius=a,this.alpha=i,this.lineWidth=o,this.rotation=0}draw(){const{ctx:t,x:e,y:s}=this;t.save(),t.translate(e,s),t.rotate(this.rotation*(Math.PI/180)),t.globalAlpha=this.alpha,this.paint(),this.lineWidth?(t.lineWidth=this.lineWidth,t.strokeStyle=this.color,t.stroke()):(t.fillStyle=this.color,t.fill()),t.globalAlpha=1,t.restore()}}class h extends c{constructor(t,e,s,n,a,i,o,r){super(t,e,s,n,a,i,r),this.sides=o}paint(){const{ctx:t,sides:e,radius:s}=this;t.beginPath(),t.moveTo(s*Math.cos(0),s*Math.sin(0));for(let n=1;n<=e;n++){const a=2*n*Math.PI/e;t.lineTo(s*Math.cos(a),s*Math.sin(a))}t.closePath()}}class d extends c{constructor(t,e,s,n,a,i,o,r){super(t,e,s,n,a,i,r),this.spikes=o}paint(){const{ctx:t,spikes:e,radius:s}=this;t.beginPath(),t.moveTo(0,-s);for(let n=0;n<2*e;n++){const a=n*Math.PI/e-Math.PI/2,i=n%2==0?s:.5*s,o=Math.cos(a)*i,r=Math.sin(a)*i;t.lineTo(o,r)}t.closePath()}}const u={circle:class extends c{paint(){const{ctx:t}=this;t.beginPath(),t.arc(0,0,this.radius,0,2*Math.PI),t.closePath()}},polygon:h,star:d,heart:class extends c{paint(){const{ctx:t,radius:e}=this,s=e/256;t.beginPath(),t.save(),t.translate(0,0),t.scale(s,s);const n=256,a=256;t.moveTo(206.3,-193.4),t.bezierCurveTo(151.5,-240.1,70,-231.7,275.7-n,-179.8),t.lineTo(0,-159.5),t.lineTo(236.3-n,-179.8),t.bezierCurveTo(-69.9,-231.7,-151.5,-240.1,-206.3,-193.4),t.bezierCurveTo(-269.1,-139.8,-272.4,212.4-a,-216.2,14.5),t.lineTo(233.3-n,214.3),t.bezierCurveTo(-16.5,220.75,-6.75,224,0,224),t.bezierCurveTo(6.75,224,16.5,220.75,278.7-n,214.3),t.lineTo(216.2,14.5),t.bezierCurveTo(272.5,212.4-a,525.2-n,-139.8,206.3,-193.4),t.closePath(),t.restore()}}},p=(t,e,s,n)=>{const a=u[n.shape],{shapeOptions:i,colors:c,number:p}=n;let{radius:f,alpha:m=1,lineWidth:y}=i;return m=l(m),Array.from({length:r(p)},(()=>{const l=c[o.random(0,c.length-1)],u=[t,e,s,l,r(f),r(m)/100];a===d?u.push(r(i.spikes)):a===h&&u.push(r(i.sides));const p=new a(...u,r(y));return((t,e)=>{const s=e.move.indexOf("emit");if(s>=0){const{emitRadius:n=[50,180]}=e.moveOptions[s]||{},a=o.random(0,360)*Math.PI/180,i=[-1,1][o.random(0,1)]*r(n);t.endPos={x:t.x+i*Math.cos(a),y:t.y+i*Math.sin(a)}}})(p,n),((t,e)=>{const s=e.move.indexOf("rotate");if(s>=0){const{angle:n=[-180,180]}=e.moveOptions[s]||{};t.endRotation=r(n)}})(p,n),p}))},f=document.createElement("canvas");f.style.cssText="position:fixed;top:0;left:0;pointer-events:none;z-index:9999999",document.body.appendChild(f);const m=f.getContext("2d"),y=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)?"touchstart":"click";let g=0,v=0;const x=()=>{if(!m)return;const{clientWidth:t,clientHeight:e}=document.documentElement;f.width=2*t,f.height=2*e,f.style.width=t+"px",f.style.height=e+"px",m.setTransform(1,0,0,1,0,0),m.scale(2,2)},b=t=>{const{move:e,moveOptions:s}=t;let n={};return e.forEach(((t,e)=>{if("emit"===t){const{radius:t=.1,alphaChange:a=!1,alphaEasing:i="linear",alphaDuration:o=[600,800],alpha:c=0}=s[e]||{};n={x:t=>t.endPos.x,y:t=>t.endPos.y,radius:r(t)},a&&(n.alpha={value:r(l(c))/100,easing:i,duration:r(o)})}else if("diffuse"===t){const{diffuseRadius:t=[80,160],lineWidth:a=0,alphaEasing:i="linear",alphaDuration:o=[600,800],alpha:c=0}=s[e]||{};n={radius:r(t),lineWidth:r(a),alpha:{value:r(l(c))/100,easing:i,duration:r(o)}}}else"rotate"===t&&(n.rotation=t=>t.endRotation)})),n},w=t=>{for(const e of t)e.draw()},M=o({duration:1/0,update(){m&&m.clearRect(0,0,f.width,f.height)}});let P=null,T=null;const E=t=>{T=t,P&&document.removeEventListener(y,P,!1),P=e=>{t.excludeElements.some((t=>((t,e)=>{for(e=e.toUpperCase();t;){if(t.nodeName===e)return!0;t=t.parentNode}return!1})(e.target,t)))||(M.play(),(t=>{var e,s;g=null!==(e=t.clientX)&&void 0!==e?e:t.touches&&t.touches[0].clientX,v=null!==(s=t.clientY)&&void 0!==s?s:t.touches&&t.touches[0].clientY})(e),A(g,v))},document.addEventListener(y,P,!1),x(),window.removeEventListener("resize",x,!1),window.addEventListener("resize",x,!1)},A=(t,e)=>{if(!T||!m)return;const{particles:s}=T,n=o().timeline();s.forEach((s=>{const{move:a,moveOptions:i}=s;s.move=Array.isArray(a)?a:[a],s.moveOptions=i?Array.isArray(i)?i:[i]:[],n.add({targets:p(m,t,e,s),duration:r(s.duration),easing:s.easing||"linear",update:w,...b(s)})})),n.play()};return t=>{"loading"===document.readyState?window.addEventListener("DOMContentLoaded",(()=>E(t)),{passive:!0}):E(t)}}));
